<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Design Patterns - Python by Example</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Design Patterns";
        var mkdocs_page_input_path = "examples\\21_design_patterns.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Python by Example
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../01_hello_world/">Hello World</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../02_variables/">Variables</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../03_comments/">Comments</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../04_operators/">Operators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../05_user_input/">User Input</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../06_control_flow/">Control Flow</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../07_functions/">Functions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../08_classes/">Classes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../09_docstrings/">Docstrings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../10_debugging/">Debugging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../11_oop_pillars/">OOP Pillars</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../12_solid_principles/">SOLID Principles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../13_logging/">Logging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../14_exceptions/">Exceptions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../15_dunder_methods/">Dunder Methods</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../16_data_types/">Data Types</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../17_import_system/">Import System</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../18_linting_tools/">Linting Tools</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../19_test_frameworks/">Test Frameworks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../20_package_managers/">Package Managers</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Design Patterns</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#abstract-factory">Abstract Factory</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#adapter-with-composition">Adapter With Composition</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#adapter-with-inheritance">Adapter With Inheritance</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#bridge">Bridge</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#builder">Builder</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#chain">Chain</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#chain-of-responsibility">Chain Of Responsibility</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#command">Command</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#composite">Composite</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#decorator">Decorator</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#facade">Facade</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#factory-class-method">Factory Class Method</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#factory-static-method">Factory Static Method</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#flyweight">Flyweight</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#interpreter">Interpreter</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#iterator">Iterator</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mediator">Mediator</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#memento">Memento</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#observer">Observer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prototype">Prototype</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#proxy">Proxy</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#singleton">Singleton</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#state">State</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#strategy">Strategy</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#template-method">Template Method</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#visitor">Visitor</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../23_meta_classes/">Meta Classes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../24_generators/">Generators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../25_coroutines/">Coroutines</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../28_optimization/">Optimization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../29_packaging/">Packaging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../30_compatibility/">Compatibility</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Project</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../project/">Python by Example Documentation</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Python by Example</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Examples</li>
      <li class="breadcrumb-item active">Design Patterns</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/braboj/tutorial-python/edit/master/docs/examples/21_design_patterns.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="design-patterns">Design Patterns</h1>
<h2 id="abstract-factory">Abstract Factory</h2>
<pre><code class="language-python"># Example: Abstract Factory

from abc import ABC, abstractmethod


class Button(ABC):
    # Abstract interface for buttons

    @abstractmethod
    def paint(self):
        raise NotImplementedError


class WinButton(Button):
    # Concrete foo for Windows buttons

    def paint(self):
        print(&quot;WinButton&quot;)


class LinuxButton(Button):

    def paint(self):
        print(&quot;LinuxButton&quot;)


class Menu(ABC):
    # Abstract interface for menus

    @abstractmethod
    def paint(self):
        raise NotImplementedError


class WinMenu(Menu):
    # Concrete foo for Windows menus

    def paint(self):
        print(&quot;WindowsMenu&quot;)


class LinuxMenu(Menu):
    # Concrete foo for Linux menus

    def paint(self):
        print(&quot;LinuxMenu&quot;)


class GUIFactory(ABC):

    # Abstract factory that declares a set of methods for creating each of the
    # products. These methods must return abstract foo types represented by
    # the abstract interfaces Button and Menu.

    @abstractmethod
    def create_button(self) -&gt; Button:
        raise NotImplementedError

    @abstractmethod
    def create_menu(self) -&gt; Menu:
        raise NotImplementedError


class WinFactory(GUIFactory):

    # The concrete factory for Windows foo variants.

    def create_button(self):
        return WinButton()

    def create_menu(self):
        return WinMenu()


class LinuxFactory(GUIFactory):

    # The concrete factory for Linux foo variants.

    def create_button(self):
        return LinuxButton()

    def create_menu(self):
        return LinuxMenu()


if __name__ == &quot;__main__&quot;:

    os = input(&quot;Select OS: &quot;)

    if os == &quot;win&quot;:
        factory = WinFactory()

    elif os == &quot;linux&quot;:
        factory = LinuxFactory()

    else:
        raise ValueError(&quot;Invalid GUI&quot;)

    # Create the GUI
    button = factory.create_button()
    menu = factory.create_menu()
    gui = [button, menu]

    # Paint the GUI
    for item in gui:
        item.paint()
</code></pre>
<h2 id="adapter-with-composition">Adapter With Composition</h2>
<pre><code class="language-python"># Example: Adapter Pattern (Object Adapter)

class ChannelV1(object):

    @staticmethod
    def applyConfig():
        # method name from actual legacy code in the company
        print('Configuration method of the old device class!')


class ChannelV2(object):

    @staticmethod
    def configure():
        print('Configuration method of the new device class!')


class ChannelAdapter(ChannelV1):
    # Class adapter (with composition)

    def __init__(self, adaptee):
        self.adaptee = adaptee

    def applyConfig(self):
        self.adaptee.configure()


def host_app(channel):
    channel.applyConfig()


if __name__ == &quot;__main__&quot;:
    # Original code using the old service
    host_app(channel=ChannelV1())

    # Use adapter for the new service adapted to the old interface
    host_app(channel=ChannelAdapter(adaptee=ChannelV2()))
</code></pre>
<h2 id="adapter-with-inheritance">Adapter With Inheritance</h2>
<pre><code class="language-python">class ChannelV1(object):

    @staticmethod
    def applyConfig():
        # method name from actual legacy code in the company (Python 2.7)
        print('Configuration method of the old device class!')


class ChannelV2(object):

    @staticmethod
    def configure():
        print('Configuration method of the new device class!')


class ChannelAdapter(ChannelV1, ChannelV2):
    # Class adapter (with inheritance)

    def applyConfig(self):
        # The adapter's applyConfig method calls the new class's configure method
        self.configure()


def host_app(channel):
    # The host_app function works with the ChannelV1 interface
    channel.applyConfig()


if __name__ == &quot;__main__&quot;:
    # Original code using the old service (ChannelV1)
    host_app(channel=ChannelV1())

    # Use adapter for the new service (ChannelV2) adapted to the old interface (ChannelV1)
    host_app(channel=ChannelAdapter())
</code></pre>
<h2 id="bridge">Bridge</h2>
<pre><code class="language-python"># Example: Bridge Pattern with shapes and colors

class Color(object):
    # Interface for Implementation

    def __init__(self, name):
        self.name = name

    def paint(self, shape):
        raise NotImplementedError


class Red(Color):
    # Concrete implementation for red color

    def __init__(self):
        super(Red, self).__init__('red')

    def paint(self, shape):
        print('Painting the {} with red color'.format(shape))


class Blue(Color):
    # Concrete implementation for blue color

    def __init__(self):
        super(Blue, self).__init__('blue')

    def paint(self, shape):
        print('Painting the {} with blue color'.format(shape))


class Shape(object):
    # This is the abstaction used by the client

    def __init__(self, color: Color):
        self.color = color

    def draw(self):
        raise NotImplementedError


class Circle(Shape):
    # Refinded abstraction for circles

    def draw(self):
        print('Drawing a circle')
        self.color.paint(shape='circle')


class Square(Shape):
    # Refined abstraction for squares

    def draw(self):
        print('Drawing a square')
        self.color.paint(shape='square')


class DrawApp(object):
    # This is the client class

    @staticmethod
    def draw(shape: Shape):
        shape.draw()


if __name__ == &quot;__main__&quot;:

    # Draw a red circle
    app = DrawApp()

    # Draw shapes
    app.draw(shape=Circle(color=Red()))
    app.draw(shape=Square(color=Blue()))
</code></pre>
<h2 id="builder">Builder</h2>
<pre><code class="language-python"># Example: Builder Pattern

from abc import ABC, abstractmethod


class Pizza(object):

    def __init__(self):
        self.crust = None
        self.cheese = None
        self.toppings = []

    def __str__(self):
        return &quot;Crust: {0}\nCheese: {1}\nToppings: {2}&quot;.format(
            self.crust,
            self.cheese,
            &quot;, &quot;.join(self.toppings)
        )


class PizzaBuilderAbc(ABC):

    @abstractmethod
    def set_crust(self, crust):
        pass

    @abstractmethod
    def add_cheese(self, cheese):
        pass

    @abstractmethod
    def add_topping(self, topping):
        pass

    @abstractmethod
    def build(self):
        pass


class MyPizzaBuilder(object):

    def __init__(self):
        self.pizza = Pizza()

    def set_crust(self, crust):
        self.pizza.crust = crust
        return self

    def add_cheese(self, cheese):
        self.pizza.cheese = cheese
        return self

    def add_topping(self, topping):
        self.pizza.toppings.append(topping)
        return self

    def build(self):
        return self.pizza


pizza = (
    MyPizzaBuilder()
    .set_crust(&quot;thin&quot;)
    .add_cheese(&quot;mozzarella&quot;)
    .add_topping(&quot;pepperoni&quot;)
    .add_topping(&quot;mushrooms&quot;)
    .build()
)

print(pizza)
</code></pre>
<h2 id="chain">Chain</h2>
<pre><code class="language-python">
</code></pre>
<h2 id="chain-of-responsibility">Chain Of Responsibility</h2>
<pre><code class="language-python"># Example: Chain of Responsibility Pattern

# Handler interface

class Approver(object):
    def __init__(self, successor=None):
        self.successor = successor

    def set_successor(self, successor):
        self.successor = successor

    def approve(self, purchase):
        pass


# Concrete handlers

class TeamLeader(Approver):
    def approve(self, purchase):
        if purchase &lt;= 1000:
            print(f&quot;Team Leader approves the purchase of ${purchase}&quot;)
        elif self.successor:
            self.successor.approve(purchase)


class Manager(Approver):
    def approve(self, purchase):
        if 1000 &lt; purchase &lt;= 5000:
            print(f&quot;Manager approves the purchase of ${purchase}&quot;)
        elif self.successor:
            self.successor.approve(purchase)


class Director(Approver):
    def approve(self, purchase):
        if 5000 &lt; purchase &lt;= 10000:
            print(f&quot;Director approves the purchase of ${purchase}&quot;)
        elif self.successor:
            self.successor.approve(purchase)


class President(Approver):
    def approve(self, purchase):
        if purchase &gt; 10000:
            print(f&quot;President approves the purchase of ${purchase}&quot;)
        elif self.successor:
            self.successor.approve(purchase)


# Client code

if __name__ == &quot;__main__&quot;:

    # Define the roles in the chain of responsibility
    team_leader = TeamLeader()
    manager = Manager()
    director = Director()
    president = President()

    # Set the successors
    team_leader.set_successor(manager)
    manager.set_successor(director)
    director.set_successor(president)


    # Create purchases
    purchases = [500, 1000, 2000, 5000, 10000, 20000]

    # Process the purchases
    for purchase in purchases:
        team_leader.approve(purchase)
</code></pre>
<h2 id="command">Command</h2>
<pre><code class="language-python"># Example: Command Pattern


# Command interface
class Command(object):
    def execute(self):
        pass

    def undo(self):
        pass


# Concrete commands
class TypeCommand(Command):
    def __init__(self, text, document):
        self.text = text
        self.document = document

    def execute(self):
        self.document.add_text(self.text)

    def undo(self):
        self.document.remove_text(self.text)


# Receiver class
class Document(object):
    def __init__(self):
        self.content = &quot;&quot;

    def add_text(self, text):
        self.content += text

    def remove_text(self, text):
        if text and text in self.content:
            self.content = self.content.replace(text, &quot;&quot;, 1)

    def get_content(self):
        return self.content


# Invoker class (TextEditor)
class TextEditor(object):

    def __init__(self):
        self.history = []

    def execute(self, command):
        command.execute()
        self.history.append(command)

    def undo_last_command(self):
        if self.history:
            command = self.history.pop()
            command.undo()


# Client code
if __name__ == &quot;__main__&quot;:

    document = Document()
    editor = TextEditor()

    print(&quot;Initial content:&quot;, document.get_content())

    # Type some text
    type_action1 = TypeCommand(&quot;Hello, &quot;, document)
    editor.execute(type_action1)
    print(&quot;After typing:&quot;, document.get_content())

    type_action2 = TypeCommand(&quot;world!&quot;, document)
    editor.execute(type_action2)
    print(&quot;After typing:&quot;, document.get_content())

    # Undo the last command
    editor.undo_last_command()
    print(&quot;After undo:&quot;, document.get_content())
</code></pre>
<h2 id="composite">Composite</h2>
<pre><code class="language-python"># Example: Composite pattern

from abc import abstractmethod


class IComponent(object):
    # Interface used by both the leaf and composite classes

    def __init__(self, name):
        self.name = name

    @abstractmethod
    def execute(self):
        raise NotImplementedError


class Leaf(IComponent):

    def execute(self):
        return &quot;{} running&quot;.format(self.name)


# Concrete implementation of the composite class
class Composite(IComponent):
    # This is the composite class (tree is composed of leafs)

    def __init__(self, name=&quot;Root&quot;):
        super(Composite, self).__init__(name)
        self.components = []

    def add(self, c):
        self.components.append(c)
        return self

    def remove(self, c):
        self.components.remove(c)
        return self

    def get_children(self):
        return self.components

    def execute(self):

        # Delegate work to all the children
        for child in self.components:
            print(&quot;{} / {}&quot;.format(self.name, child.execute()))

        return &quot;{} running&quot;.format(self.name)


if __name__ == &quot;__main__&quot;:

    # Define composite foo
    product = Composite()
    product.add(Leaf(&quot;Leaf 1&quot;))
    product.add(Leaf(&quot;Leaf 2&quot;))
    print(product.execute())

    print()

    # Nested composite foo
    product.add(
        Composite(&quot;Subsystem A&quot;)
        .add(Leaf(&quot;Leaf 1&quot;))
        .add(Leaf(&quot;Leaf 2&quot;))
    )
    print(product.execute())
</code></pre>
<h2 id="decorator">Decorator</h2>
<pre><code class="language-python"># Example: Decorator Pattern

from abc import ABC, abstractmethod


class NotifierAbc(ABC):

    @abstractmethod
    def notify(self):
        pass


class Notifier(NotifierAbc):

    def notify(self):
        print(&quot;Print on screen ...&quot;)


class NotifierDecorator(NotifierAbc):

    def __init__(self, component):
        self._component = component

    @abstractmethod
    def notify(self):
        pass


class EmailNotifier(NotifierDecorator):

    @staticmethod
    def send_email():
        print(&quot;Sending email ...&quot;)

    def notify(self):
        self.send_email()
        self._component.notify()


class SMSNotifier(NotifierDecorator):

    @staticmethod
    def send_sms():
        print(&quot;Sending SMS ...&quot;)

    def notify(self):
        self.send_sms()
        self._component.notify()


def main():
    notifier = Notifier()
    notifier_with_email = EmailNotifier(notifier)
    notifier_with_email_and_sms = SMSNotifier(notifier_with_email)
    notifier_with_email_and_sms.notify()


if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<h2 id="facade">Facade</h2>
<pre><code class="language-python"># Example: Facade Pattern

class PumpSystem(object):

    @staticmethod
    def prepare():
        print(&quot;SubsystemA prepare ...&quot;)

    @staticmethod
    def run():
        print(&quot;SubsystemA run ...&quot;)


class VentilationSystem(object):

    @staticmethod
    def prepare():
        print(&quot;SubsystemB prepare ...&quot;)

    @staticmethod
    def run():
        print(&quot;SubsystemB run ...&quot;)


class ComplexSystemFacade(object):

    def __init__(self):
        self._subsystemA = PumpSystem()
        self._subsystemB = VentilationSystem()

    def run(self):
        self._subsystemA.prepare()
        self._subsystemB.prepare()
        self._subsystemA.run()
        self._subsystemB.run()


def main():
    system = ComplexSystemFacade()
    system.run()


if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<h2 id="factory-class-method">Factory Class Method</h2>
<pre><code class="language-python"># Example: Factory Method as a class method

class Transport(object):
    def __init__(self):
        pass

    def deliver(self):
        pass


class Truck(Transport):
    def deliver(self):
        print(&quot;Delivering by land in a box&quot;)


class Ship(Transport):
    def deliver(self):
        print(&quot;Delivering by sea in a container&quot;)


class Logistic(object):
    def __init__(self, transport):
        self.transport = transport

    def deliver(self):
        self.transport.deliver()

    @classmethod
    def from_json(cls, json):
        # Factory method

        # Get transport type
        token = json.get(&quot;transport_type&quot;)

        # Convert to lowercase and remove whitespace
        transport_type = token.lower().strip(&quot; \t\n\r&quot;)

        # Factory logic
        if transport_type == &quot;truck&quot;:
            return Truck()

        elif transport_type == &quot;ship&quot;:
            return Ship()

        else:
            raise ValueError(&quot;Invalid transport type&quot;)


class App(object):

    @staticmethod
    def run():

        # Select transport
        json = {&quot;transport_type&quot;: &quot;truck&quot;}
        transport = Logistic.from_json(json)

        # Deliver
        logistic = Logistic(transport)
        logistic.deliver()


if __name__ == &quot;__main__&quot;:
    app = App()
    app.run()
</code></pre>
<h2 id="factory-static-method">Factory Static Method</h2>
<pre><code class="language-python"># Example: Factory Method as a static Method

class Transport(object):
    def __init__(self):
        pass

    def deliver(self):
        pass


class Truck(Transport):
    def deliver(self):
        print(&quot;Delivering by land in a box&quot;)


class Ship(Transport):
    def deliver(self):
        print(&quot;Delivering by sea in a container&quot;)


class Logistic(object):
    def __init__(self, transport):
        self.transport = transport

    def deliver(self):
        self.transport.deliver()


class App(object):

    @staticmethod
    def select_transport():
        # Factory method

        # Get transport type
        token = input(&quot;Select transport type: &quot;)

        # Convert to lowercase and remove whitespace
        transport_type = token.lower().strip(&quot; \t\n\r&quot;)

        # Factory logic
        if transport_type == &quot;truck&quot;:
            return Truck()

        elif transport_type == &quot;ship&quot;:
            return Ship()

        else:
            raise ValueError(&quot;Invalid transport type&quot;)

    def run(self):

        # Select transport
        transport = self.select_transport()

        # Deliver
        logistic = Logistic(transport)
        logistic.deliver()


if __name__ == &quot;__main__&quot;:
    app = App()
    app.run()
</code></pre>
<h2 id="flyweight">Flyweight</h2>
<pre><code class="language-python"># Exercise: Flyweight Pattern

# Shared state (flyweight object)
class CoffeeFlavor(object):

    def __init__(self, flavor):
        self._flavor = flavor

    def get_flavor(self):
        return self._flavor


# Unique state (context object)
class CoffeeOrder(object):

    def __init__(self, table_number, flavor):
        self._table_number = table_number
        self._flavor = flavor

    def serve(self):
        print(f&quot;Serving coffee to table {self._table_number} with flavor {self._flavor.get_flavor()}&quot;)


# Flyweight factory (manages the flyweight and context objects)
class CoffeeShop(object):

    def __init__(self):

        # Cache for the orders and flavors
        self._orders = {}
        self._flavors = {}

    def take_order(self, table_number, flavor_name):

        # Check if the flavor instance is already cached
        flavor = self._flavors.get(flavor_name)

        # If not, create a new flavor instance and cache it
        if not flavor:
            flavor = CoffeeFlavor(flavor_name)
            self._flavors[flavor_name] = flavor

        # Create a new order with the shared flavor and unique table number
        order = CoffeeOrder(table_number, flavor)
        self._orders[table_number] = order

    def serve_orders(self):
        for table_number, order in self._orders.items():
            order.serve()


# Client code
if __name__ == &quot;__main__&quot;:

    # Create the coffee shop
    coffee_shop = CoffeeShop()

    # Take orders from the customers
    coffee_shop.take_order(1, &quot;Cappuccino&quot;)
    coffee_shop.take_order(2, &quot;Espresso&quot;)
    coffee_shop.take_order(3, &quot;Cappuccino&quot;)
    coffee_shop.take_order(4, &quot;Espresso&quot;)

    # Serve the orders
    coffee_shop.serve_orders()
</code></pre>
<h2 id="interpreter">Interpreter</h2>
<pre><code class="language-python"># Example: Interpreter Pattern

# Abstract Expression
class Expression(object):

    def interpret(self, context):
        raise NotImplementedError


# Terminal Expression
class Number(Expression):

    def __init__(self, value):
        self.value = value

    def interpret(self, context):
        return self.value


# Non-terminal Expression
class Add(Expression):

    def __init__(self, left, right):
        self.left = left
        self.right = right

    def interpret(self, context):
        return self.left.interpret(context) + self.right.interpret(context)


# Context
class Context(object):

    def __init__(self):
        self.variables = {}

    def set(self, variable, value):
        self.variables[variable] = value

    def get(self, variable):
        return self.variables.get(variable, 0)


# Client code
if __name__ == &quot;__main__&quot;:

    context = Context()
    context.set(&quot;x&quot;, 10)
    context.set(&quot;y&quot;, 5)

    expression = Add(
        Number(context.get(&quot;x&quot;)),
        Number(context.get(&quot;y&quot;))
    )

    result = expression.interpret(context)
    print(&quot;Result: {}&quot;.format(result))
</code></pre>
<h2 id="iterator">Iterator</h2>
<pre><code class="language-python"># Example: Iterator Pattern


# Iterator interface
class Iterator(object):
    def has_next(self):
        pass

    def next(self):
        pass


# TreeNode represents a node in a tree
class TreeNode(object):
    def __init__(self, data):
        self.data = data
        self.children = []

    def add_child(self, child):
        self.children.append(child)


# Concrete Iterator for tree traversal
class TreeIterator(Iterator):
    def __init__(self, root):
        self.stack = [root]

    def has_next(self):
        return len(self.stack) &gt; 0

    def next(self):
        if not self.has_next():
            raise StopIteration()

        node = self.stack.pop()
        for child in reversed(node.children):
            self.stack.append(child)
        return node.data


# Client code
if __name__ == &quot;__main__&quot;:

    # Create a sample tree structure
    root = TreeNode(&quot;Root&quot;)
    child1 = TreeNode(&quot;Child 1&quot;)
    child2 = TreeNode(&quot;Child 2&quot;)
    child3 = TreeNode(&quot;Child 3&quot;)

    # Add nodes to the tree
    root.add_child(child1)
    root.add_child(child2)
    child2.add_child(child3)

    # Create a tree iterator
    iterator = TreeIterator(root)

    # Traverse and print tree nodes
    while iterator.has_next():
        node = iterator.next()
        print(node)
</code></pre>
<h2 id="mediator">Mediator</h2>
<pre><code class="language-python"># Example: Mediator Pattern


# Mediator interface
class Mediator(object):

    def forward(self, message, component):
        raise NotImplementedError


# Concrete Mediator
class Dialog(Mediator):

    def __init__(self):
        self.components = []

    def set_component(self, component):
        self.components.append(component)

    def forward(self, message, sender):
        for component in self.components:
            if sender is not component:
                component.receive(message)


# Component interface
class Component(object):

    def __init__(self, mediator):
        self.mediator = mediator

    def send(self, message):
        raise NotImplementedError

    def receive(self, message):
        raise NotImplementedError


# Concrete Component
class Button(Component):

    def send(self, message):
        print(f&quot;Button sends: {message}&quot;)
        self.mediator.forward(message, self)

    def receive(self, message):
        print(f&quot;Button receives: {message}&quot;)


# Concrete Component
class Textbox(Component):

    def send(self, message):
        print(f&quot;Textbox sends: {message}&quot;)
        self.mediator.forward(message, self)

    def receive(self, message):
        print(f&quot;Textbox receives: {message}&quot;)


# Concrete Component
class Checkbox(Component):

    def send(self, message):
        print(f&quot;Checkbox sends: {message}&quot;)
        self.mediator.forward(message, self)

    def receive(self, message):
        print(f&quot;Checkbox receives: {message}&quot;)


# Client code
if __name__ == &quot;__main__&quot;:

    # Create the mediator
    mediator = Dialog()

    # Add components to the mediator
    button = Button(mediator)
    mediator.set_component(button)

    # Add more components to the mediator
    textbox = Textbox(mediator)
    mediator.set_component(textbox)

    # Add more components to the mediator
    checkbox = Checkbox(mediator)
    mediator.set_component(checkbox)

    # Send messages
    button.send(&quot;Hello from Button!&quot;)
</code></pre>
<h2 id="memento">Memento</h2>
<pre><code class="language-python"># Example: Memento Pattern

# Originator class
class TextEditor:
    def __init__(self):
        self.content = &quot;&quot;

    def write(self, text):
        self.content += text

    def show_content(self):
        print(f&quot;Editor Content: {self.content}&quot;)

    def create_memento(self):
        return TextEditorMemento(self.content)

    def restore_from_memento(self, memento):
        self.content = memento.get_state()


# Memento class
class TextEditorMemento:
    def __init__(self, content):
        self.content = content

    def get_state(self):
        return self.content


# Caretaker class
class History:
    def __init__(self):
        self.states = []

    def push(self, memento):
        self.states.append(memento)

    def pop(self):
        if self.states:
            return self.states.pop()
        return None


# Client code
if __name__ == &quot;__main__&quot;:

    text_editor = TextEditor()
    history = History()

    text_editor.write(&quot;Hello, &quot;)
    history.push(text_editor.create_memento())

    text_editor.write(&quot;world!&quot;)
    history.push(text_editor.create_memento())

    text_editor.show_content()

    text_editor.write(&quot; Hello, hello!&quot;)
    text_editor.show_content()

    # Undo the last action
    last_state = history.pop()
    if last_state:
        text_editor.restore_from_memento(last_state)

    text_editor.show_content()
</code></pre>
<h2 id="observer">Observer</h2>
<pre><code class="language-python"># Example: Observer Pattern

# Subject Interface (produces data)
class Publisher(object):

    def attach(self, observer):
        pass

    def detach(self, observer):
        pass

    def notify(self):
        pass


# Concrete Subject
class WeatherData(Publisher):

    def __init__(self):
        self.subscribers = []
        self.temperature = 0.0
        self.humidity = 0.0
        self.pressure = 0.0

    def attach(self, observer):
        self.subscribers.append(observer)

    def detach(self, observer):
        self.subscribers.remove(observer)

    def notify(self):
        for subscriber in self.subscribers:
            subscriber.update(self.temperature, self.humidity, self.pressure)

    def set(self, temperature, humidity, pressure):
        self.temperature = temperature
        self.humidity = humidity
        self.pressure = pressure
        self.notify()


# Observer interface (consumes data)
class Subscriber(object):

    def update(self, temperature, humidity, pressure):
        pass


# Concrete Observer
class DisplayDevice(Subscriber):

    def __init__(self, name):
        self.name = name

    def update(self, temperature, humidity, pressure):
        print(
            f&quot;{self.name} Display - Temperature: {temperature}°C, Humidity: {humidity}%, Pressure: {pressure} hPa&quot;)


# Client code
if __name__ == &quot;__main__&quot;:

    # Create a weather station
    weather_station = WeatherData()

    # Attach a display device to the weather station
    display1 = DisplayDevice(&quot;Display 1&quot;)
    weather_station.attach(display1)

    # Attach another display device to the weather station
    display2 = DisplayDevice(&quot;Display 2&quot;)
    weather_station.attach(display2)

    # Simulate changes in weather data
    weather_station.set(25.0, 60.0, 1013.0)
    weather_station.set(26.5, 55.0, 1010.5)
</code></pre>
<h2 id="prototype">Prototype</h2>
<pre><code class="language-python"># Example: Prototype Pattern

from abc import ABC, abstractmethod


# Prototype interface
class Prototype(ABC):

    @abstractmethod
    def clone(self):
        pass


# Concrete Prototype
class Pizza(Prototype):

    def __init__(self, crust, cheese, toppings):
        self.crust = crust
        self.cheese = cheese
        self.toppings = toppings

    def __str__(self):
        return &quot;Crust: {0}\nCheese: {1}\nToppings: {2}&quot;.format(
            self.crust,
            self.cheese,
            &quot;, &quot;.join(self.toppings)
        )

    def clone(self):
        return Pizza(self.crust, self.cheese, self.toppings)


if __name__ == &quot;__main__&quot;:

    pizza = Pizza(&quot;thin&quot;, &quot;mozzarella&quot;, [&quot;pepperoni&quot;, &quot;mushrooms&quot;])

    pizza_clone = pizza.clone()
    print(pizza_clone)

    print(pizza == pizza_clone)
    print(pizza is pizza_clone)
</code></pre>
<h2 id="proxy">Proxy</h2>
<pre><code class="language-python"># Example: Proxy Pattern

class Server(object):

    def request(self):
        raise NotImplementedError


class RealServer(Server):

    def request(self):
        print(&quot;RealServer: Handling request.&quot;)


class ProxyServer(Server):

    def __init__(self, server: Server = None):
        self._server = server

    def request(self):
        if self.check_access():
            self._server.request()
            self.log_access()

    @staticmethod
    def check_access():
        print(&quot;ProxyServer: Checking access prior to firing a real request.&quot;)
        return True

    @staticmethod
    def log_access():
        print(&quot;ProxyServer: Logging the time of request.&quot;, end=&quot;&quot;)


class Client(object):

    def __init__(self, server: Server):
        self._server = server

    def execute(self):
        self._server.request()


if __name__ == &quot;__main__&quot;:

    print(&quot;Client: Executing the client code with a real server&quot;)
    real_server = RealServer()
    client = Client(server=real_server)
    client.execute()

    print(&quot;&quot;)

    print(&quot;Client: Executing the same client code with a proxy server&quot;)
    client = Client(server=ProxyServer(real_server))
    client.execute()
</code></pre>
<h2 id="singleton">Singleton</h2>
<pre><code class="language-python"># Example: Singleton Pattern with __new__


class Singleton(object):

    __instance = None

    def __new__(cls):
        if cls.__instance is None:
            cls.__instance = super(Singleton, cls).__new__(cls)

        return cls.__instance


s1 = Singleton()
s2 = Singleton()

print(s1 is s2)
</code></pre>
<h2 id="state">State</h2>
<pre><code class="language-python"># State interface
class State(object):

    def connect(self):
        raise NotImplementedError

    def disconnect(self):
        raise NotImplementedError

    def send_data(self, data):
        raise NotImplementedError


# Concrete State: Disconnected
class DisconnectedState(State):

    def connect(self):

        # Action
        print(&quot;Connecting to the server...&quot;)

        # Transition to the Connected state
        return ConnectedState()

    def disconnect(self):
        print(&quot;Already disconnected.&quot;)
        return self

    def send_data(self, data):

        print(&quot;Cannot send data while disconnected.&quot;)
        return self


# Concrete State: Connected
class ConnectedState(State):

    def connect(self):

        # Action
        print(&quot;Already connected.&quot;)

        # Transition
        return self

    def disconnect(self):
        # Action
        print(&quot;Disconnecting from the server...&quot;)

        # Transition
        return DisconnectedState()

    def send_data(self, data):
        # Action
        print(f&quot;Sending data to the server: {data}&quot;)

        # Transition
        return self


# Context class
class Client(object):

    def __init__(self):
        # Initial state
        self.state = DisconnectedState()

    def connect(self):
        self.state = self.state.connect()

    def disconnect(self):
        self.state = self.state.disconnect()

    def send_data(self, data):
        self.state.send_data(data)


# Client code
if __name__ == &quot;__main__&quot;:

    client = Client()

    client.send_data(&quot;Hello, server!&quot;)  # Try sending data while disconnected

    client.connect()
    client.send_data(&quot;Hello, server!&quot;)  # Send data after connecting

    client.connect()  # Try connecting again

    client.disconnect()
    client.send_data(&quot;Goodbye, server!&quot;)  # Send data after disconnecting
</code></pre>
<h2 id="strategy">Strategy</h2>
<pre><code class="language-python"># Example: Strategy Pattern

# Strategy interface
class TextFormatter(object):

    def format_text(self, text):
        raise NotImplementedError


# Concrete Strategy: Uppercase formatting
class UppercaseFormatter(TextFormatter):

    def format_text(self, text):
        return text.upper()


# Concrete Strategy: Lowercase formatting
class LowercaseFormatter(TextFormatter):
    def format_text(self, text):
        return text.lower()


# Concrete Strategy: Title case formatting
class TitleCaseFormatter(TextFormatter):

    def format_text(self, text):
        return text.title()


# Context class
class TextEditor(object):
    def __init__(self, formatter):
        self.formatter = formatter

    def set_formatter(self, formatter):
        self.formatter = formatter

    def format_text(self, text):
        return self.formatter.format_text(text)


# Client code
if __name__ == &quot;__main__&quot;:

    text = &quot;This is a simple example of the Strategy Pattern.&quot;

    # Create text editor with the default uppercase formatting strategy
    editor = TextEditor(UppercaseFormatter())
    result = editor.format_text(text)
    print(&quot;Uppercase Formatting:&quot;)
    print(result)

    # Change the formatting strategy to lowercase
    editor.set_formatter(LowercaseFormatter())
    result = editor.format_text(text)
    print(&quot;\nLowercase Formatting:&quot;)
    print(result)

    # Change the formatting strategy to title case
    editor.set_formatter(TitleCaseFormatter())
    result = editor.format_text(text)
    print(&quot;\nTitle Case Formatting:&quot;)
    print(result)
</code></pre>
<h2 id="template-method">Template Method</h2>
<pre><code class="language-python"># Example: Template Method Pattern

# Abstract with template methods
class Notification(object):

    # Template method
    def send_notification(self, message):
        self.authenticate()
        self.format_message(message)
        self.send_message()

    # Template method
    def authenticate(self):
        print(&quot;Authentication successful&quot;)

    # Template method
    def format_message(self, message):
        print(f&quot;Formatting message: {message}&quot;)

    # Abstract method
    def send_message(self):
        raise NotImplementedError


# Concrete Notification subclass for email
class EmailNotification(Notification):

    def send_message(self):
        print(&quot;Sending email...&quot;)


# Concrete Notification subclass for SMS
class SMSNotification(Notification):

    def send_message(self):
        print(&quot;Sending SMS...&quot;)


# Client code
if __name__ == &quot;__main__&quot;:
    email_notification = EmailNotification()
    sms_notification = SMSNotification()

    text = &quot;This is a notification message.&quot;

    print(&quot;Email Notification:&quot;)
    email_notification.send_notification(text)

    print(&quot;\nSMS Notification:&quot;)
    sms_notification.send_notification(text)
</code></pre>
<h2 id="visitor">Visitor</h2>
<pre><code class="language-python"># Example: Visitor Pattern

class ExportVisitor(object):

    def visit(self, element):
        pass


class XMLExportVisitor(ExportVisitor):

    def visit(self, element):
        print('XML exporter visiting element of type {0}'.format(type(element).__name__))


class Node(object):

    def accept(self, visitor):
        pass


class City(Node):

    def accept(self, visitor):
        visitor.visit(self)


class Industry(Node):

    def accept(self, visitor):
        visitor.visit(self)


class NavigationMap(object):

    def __init__(self):
        self.nodes = []

    def add(self, element):
        self.nodes.append(element)

    def accept(self, visitor):
        for element in self.nodes:
            element.accept(visitor)


if __name__ == &quot;__main__&quot;:
    exporter = XMLExportVisitor()
    object_structure = NavigationMap()
    object_structure.add(City())
    object_structure.add(Industry())
    object_structure.accept(exporter)
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../20_package_managers/" class="btn btn-neutral float-left" title="Package Managers"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../23_meta_classes/" class="btn btn-neutral float-right" title="Meta Classes">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/braboj/tutorial-python" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../20_package_managers/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../23_meta_classes/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
